@model IEnumerable<Foodshare.Models.Donation>

@{
    ViewBag.Title = "Donations";
}

<h2>Donations</h2>

@if (!ViewBag.EmailConfirmed)
{
<div class="row">
    <div class="col-xs-12 text-danger"><h3>Warning: You won't get any notifications until you verify your email</h3></div>
</div>
}

<div class="row">
    <div class="col-xs-12 text-right">

        <a class="btn btn-danger btn-lg" href="@Url.Action("Edit" )"><span class="glyphicon glyphicon-plus"></span> New Donation</a>

    </div>

</div>


@foreach (var item in Model) {



<div class="row" style="margin-top: 1em;">
        <div class="col-xs-12 col-sm-3 ">
            <img src="@Html.DisplayFor(modelItem => item.ImageUrl)" style="width: 100%; max-height: 500px; margin: 0 auto;"/>
        </div>
        <div class="col-xs-12 col-sm-6">
          <h2>@Html.DisplayFor(modelItem => item.Title)</h2> <br>
          <p>
          @Html.DisplayFor(modelItem => item.Location)<br>
          @Html.DisplayFor(modelItem => item.Description)</p>

            <div></div>
        </div>
        <div class="col-xs-12 col-sm-3">

            @if (item.DonatedById == ViewBag.UserId)
            {
                <p style="margin-top: 1em;"><a class="btn btn-default" href="@Url.Action("Edit", new { id = item.DonationId })">Edit</a></p>
            }

            @if (User.IsInRole("Agency") && item.ClaimedById == null && item.AvailableTo > DateTime.Now && item.DonatedById != ViewBag.UserId)
            {
                <p style="margin-top: 1em;"><a class="btn btn-default btn-lg" href="@Url.Action("Claim", new { id = item.DonationId })"><span class="glyphicon glyphicon-heart"></span> Claim</a></p>
            }

            @if (item.AvailableTo < DateTime.Now)
            {
                <p style="margin-top: 1em;" class="text-danger">Donation is no longer available</p>
            }
            
            @if (item.ClaimedById != null && item.ClaimedById != ViewBag.UserId)
            {
                <p style="margin-top: 1em;" class="text-danger">Donation has been claimed </p>
            }

            @if (item.ClaimedById != null && item.ClaimedById == ViewBag.UserId)
            {
                <p style="margin-top: 1em;" class="text-success">You have claimed this Donation</p>
            }
      </div>
    </div>
    <br>

    }



   
